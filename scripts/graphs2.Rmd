---
title: "Blog 2"
author: "Mirosgav Bergam"
date: "9/17/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mefa) #for fill_na()
library(useful)
```

```{r, warning = FALSE, message = FALSE}

# Ranking unemployment ranks to brainstorm states to model on

unemployment_rank <- read_csv("../data/local.csv") %>%
  group_by(`State and area`) %>%
  summarise(avg_unemployment = mean(Unemployed_prce)) %>%
  arrange(desc(avg_unemployment)) %>%
  head(25)

unemployment_rank

ga_data <- read_csv("../data/local.csv") %>%
  filter(`State and area` == "Georgia",
         Month %in% c('01', '02', '03', '04', '05', '06', '07', '08')) %>%
  group_by(Year) %>%
  summarise(unemployment = mean(Unemployed_prce)) %>%
  mutate(year = Year) %>%
  select(year, unemployment)

us_data <- read_csv("../data/econ.csv") %>%
  drop_na() %>%
  filter(quarter == 2 | quarter == 1) %>%
  group_by(year) %>%
  summarise(unemployment = mean(unemployment)) %>%
  select(unemployment, year)

ga_data
us_data

```

```{r, warning = FALSE, message = FALSE}

incumbent <- read_csv("../data/presidents.csv") %>%
  select(Party, office) %>%
  separate(office, into = c("junk", "junk2", "year"), sep = "/") %>%
  mutate(party = Party,
         year = as.numeric(year),
         year = year - 1) %>%
  select(year, party) 

ga_voting <- read_csv("../data/popvote_bystate_1948-2016.csv") %>%
  filter(state == "Georgia") %>%
  left_join(incumbent, by = "year")
  
ga_voting <- fill.na(ga_voting) %>%
  arrange(year)

ga_voting <- shift.column(data = ga_voting, columns = "party", up = FALSE, len = 1)

ga_voting <- ga_voting %>%
  mutate(incumbent = party.Shifted) %>%
  mutate(incumbent_voteshare = case_when(
    incumbent == "Republican" ~ R_pv2p,
    incumbent == "Democratic" ~ D_pv2p
  )) %>%
  select(year, incumbent_voteshare, incumbent) %>%
  left_join(ga_data, by = "year") %>%
  mutate(ga_unemployment = unemployment) %>%
  select(!unemployment) %>%
  left_join(us_data, by = "year") %>%
  mutate(us_unemployment = unemployment) %>%
  select(!unemployment) %>%
  drop_na()
  
ga_voting %>%
  ggplot(aes(x = ga_unemployment , y = incumbent_voteshare)) +
  geom_point() + 
  geom_smooth(method = "lm") +  
  geom_text(aes(label = year, hjust=-0.1, vjust=1.1)) + 
  labs(title = "Incumbent Voteshare by Georgia Unemployment",
       subtitle = "There exists a weak, negative correlation",
       x = "Georgia Election Year Q1 and Q2 Unemployment Rate",
       y = "Incumbent 2-Party Voteshare in Georgia")

ggsave("../figures/GAunemployed.jpg", height = 4, width = 6)

```

```{r}

ga_voting %>%
  ggplot(aes(x = us_unemployment, y = incumbent_voteshare, label = year)) +
  geom_point() + 
  geom_text(aes(label = year, hjust=-0.1, vjust=1.1)) + 
  geom_smooth(method = "lm") +
  labs(title = "Incumbent Voteshare by U.S. Unemployment",
       subtitle = "There exists a very weak, negative correlation",
       x = "U.S. Election Year Q1 and Q2 Unemployment Rate",
       y = "Incumbent 2-Party Voteshare in Georgia")


ggsave("../figures/usunemployed.jpg", height = 4, width = 6)

```


```{r}

ga <- lm(ga_unemployment ~ incumbent_voteshare, data = ga_voting)

us <- lm(us_unemployment ~ incumbent_voteshare, data = ga_voting)

summary(ga)$r.squared

summary(us)$r.squared

```

```{r}

ga_voting %>%
  ggplot(aes(x = ga_unemployment, y = incumbent_voteshare, label = year, color = incumbent)) +
  geom_point() + 
  geom_text(aes(label = year, hjust=-0.1, vjust=1.1)) + 
  geom_smooth(method = "lm") +
  scale_color_manual(values = c("Democratic" = "blue", 
                                "Republican" = "red")) + 
  labs(title = "Incumbent Voteshare by Georgia Unemployment for Each Party",
       subtitle = "Negative correlation is present for Republicans, but not Democrats",
       x = "U.S. Election Year Q1 and Q2 Unemployment Rate",
       y = "Incumbent 2-Party Voteshare",
       color = "Incumbent Party")

ggsave("../figures/GAunemployed_party.jpg", height = 4, width = 6)

```
```{r}

ga_voting %>%
  ggplot(aes(x = us_unemployment, y = incumbent_voteshare, label = year, color = incumbent)) +
  geom_point() + 
  geom_text(aes(label = year, hjust=-0.1, vjust=1.1)) + 
  geom_smooth(method = "lm") +
  scale_color_manual(values = c("Democratic" = "blue", 
                                "Republican" = "red")) + 
  labs(title = "Incumbent Voteshare by U.S. Unemployment for Each Party",
       subtitle = "Negative correlation is present for Republicans, but not Democrats",
       x = "U.S. Election Year Q1 and Q2 Unemployment Rate",
       y = "Incumbent 2-Party Voteshare in Georgia",
       color = "Incumbent Party")


ggsave("../figures/usunemployed_party.jpg", height = 4, width = 6)

```




